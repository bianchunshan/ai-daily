<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>股票详情 - 前沿科技日报</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', sans-serif; background: #f4f5f6; line-height: 1.6; }
        .header { background: #d43030; color: #fff; padding: 12px 15px; position: sticky; top: 0; z-index: 100; }
        .nav { display: flex; overflow-x: auto; gap: 20px; padding: 10px 15px; background: #fff; border-bottom: 1px solid #e8e8e8; }
        .nav a { color: #666; text-decoration: none; font-size: 14px; white-space: nowrap; }
        .nav a.active { color: #d43030; font-weight: bold; }
        .stock-header { background: #fff; padding: 20px; margin-bottom: 15px; }
        .stock-name { font-size: 20px; font-weight: bold; color: #333; }
        .stock-code { font-size: 14px; color: #999; margin-left: 10px; }
        .stock-price { font-size: 36px; font-weight: bold; color: #333; margin-top: 10px; }
        .stock-change { font-size: 16px; margin-top: 5px; }
        .stock-change.up { color: #d43030; }
        .stock-change.down { color: #00b578; }
        .stock-info { display: flex; flex-wrap: wrap; background: #fff; padding: 15px; margin-bottom: 15px; }
        .info-item { width: 33.33%; padding: 10px; }
        .info-label { font-size: 12px; color: #999; }
        .info-value { font-size: 14px; color: #333; margin-top: 5px; }
        .section { background: #fff; margin-bottom: 15px; padding: 15px; }
        .section-title { font-size: 16px; font-weight: bold; color: #333; margin-bottom: 15px; border-left: 3px solid #d43030; padding-left: 10px; }
        .api-config { background: #fff8f8; border: 1px solid #ffd4d4; padding: 15px; margin: 15px; border-radius: 4px; }
        .api-config input { width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ddd; border-radius: 4px; }
        .api-config button { background: #d43030; color: #fff; border: none; padding: 8px 16px; margin-top: 10px; border-radius: 4px; cursor: pointer; }
        .footer { background: #333; color: #999; text-align: center; padding: 20px; margin-top: 20px; font-size: 12px; }
    </style>
</head>
<body>
    <div class="header">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <div style="font-size: 18px; font-weight: bold;">前沿科技日报</div>
            <div>
                <button onclick="alert('登录功能开发中')" style="background: #fff; color: #d43030; border: none; padding: 6px 16px; border-radius: 4px; font-size: 14px; cursor: pointer; margin-right: 8px;">登录</button>
                <button onclick="alert('注册功能开发中')" style="background: transparent; color: #fff; border: 1px solid #fff; padding: 6px 16px; border-radius: 4px; font-size: 14px; cursor: pointer;">注册</button>
            </div>
        </div>
    </div>
    
    <div class="nav">
        <a href="index.html">首页</a>
        <a href="ai.html">人工智能</a>
        <a href="semiconductor.html">半导体</a>
        <a href="new-energy.html">新能源</a>
        <a href="biotech.html">生物医药</a>
        <a href="frontier.html">前沿科技</a>
    </div>

    <!-- API Key 配置 -->
    <div class="api-config" id="apiConfig">
        <div style="font-weight: bold; color: #d43030; margin-bottom: 10px;">⚠️ 需要配置 Finnhub API Key</div>
        <div>1. 访问 <a href="https://finnhub.io" target="_blank">finnhub.io</a> 免费注册</div>
        <div>2. 获取 API Key 并填入下方：</div>
        <input type="text" id="apiKeyInput" placeholder="请输入 Finnhub API Key" value="">
        <button onclick="saveApiKey()">保存并加载数据</button>
    </div>

    <div class="stock-header" style="display: none;" id="stockInfo">
        <div>
            <span class="stock-name" id="stockName">--</span>
            <span class="stock-code" id="stockCode">--</span>
        </div>
        <div class="stock-price" id="stockPrice">--</div>
        <div class="stock-change" id="stockChange">--</div>
    </div>

    <div class="stock-info" style="display: none;" id="stockDetails">
        <div class="info-item"><div class="info-label">今开</div><div class="info-value" id="openPrice">--</div></div>
        <div class="info-item"><div class="info-label">最高</div><div class="info-value" id="highPrice">--</div></div>
        <div class="info-item"><div class="info-label">最低</div><div class="info-value" id="lowPrice">--</div></div>
        <div class="info-item"><div class="info-label">昨收</div><div class="info-value" id="prevClose">--</div></div>
        <div class="info-item"><div class="info-label">市值</div><div class="info-value" id="marketCap">--</div></div>
        <div class="info-item"><div class="info-label">数据来源</div><div class="info-value">Finnhub</div></div>
    </div>

    <div class="section">
        <div class="section-title">相关资讯</div>
        <div id="relatedNews"><div style="padding: 20px; color: #999;">请先配置 API Key</div></div>
    </div>

    <div class="footer">
        <p>前沿科技日报 · 全球科技投资情报 · 每日更新</p>
    </div>

    <script>
        // 股票映射
        const stockMap = {
            'NVDA': { name: '英伟达', symbol: 'NVDA' },
            'AMD': { name: 'AMD', symbol: 'AMD' },
            'TSM': { name: '台积电', symbol: 'TSM' },
            'AAPL': { name: '苹果', symbol: 'AAPL' },
            'MSFT': { name: '微软', symbol: 'MSFT' },
            'GOOGL': { name: '谷歌', symbol: 'GOOGL' },
            'META': { name: 'Meta', symbol: 'META' },
            'TSLA': { name: '特斯拉', symbol: 'TSLA' },
            'AMZN': { name: '亚马逊', symbol: 'AMZN' },
            'AVGO': { name: '博通', symbol: 'AVGO' },
            'LLY': { name: '礼来', symbol: 'LLY' },
            'NVO': { name: '诺和诺德', symbol: 'NVO' },
            'INTC': { name: '英特尔', symbol: 'INTC' },
            '300750.SZ': { name: '宁德时代', symbol: '300750.SZ' },
            '601012.SH': { name: '隆基绿能', symbol: '601012.SH' },
            'BYD': { name: '比亚迪', symbol: '1211.HK' }
        };

        const urlParams = new URLSearchParams(window.location.search);
        const stockCode = urlParams.get('code');
        let API_KEY = 'd6hg3j1r01qr5k4br23gd6hg3j1r01qr5k4br240';

        // API Key 已配置，直接加载
        document.getElementById('apiConfig').style.display = 'none';
        document.getElementById('stockInfo').style.display = 'block';
        document.getElementById('stockDetails').style.display = 'flex';
        loadStockData();

        function saveApiKey() {
            const key = document.getElementById('apiKeyInput').value.trim();
            if (key) {
                localStorage.setItem('finnhub_api_key', key);
                API_KEY = key;
                location.reload();
            } else {
                alert('请输入有效的 API Key');
            }
        }

        async function loadStockData() {
            if (!stockCode || !stockMap[stockCode]) {
                document.getElementById('stockName').textContent = '股票代码错误';
                return;
            }

            const stock = stockMap[stockCode];
            document.getElementById('stockName').textContent = stock.name;
            document.getElementById('stockCode').textContent = stockCode;

            try {
                const response = await fetch(`https://finnhub.io/api/v1/quote?symbol=${stock.symbol}&token=${API_KEY}`);
                const data = await response.json();

                if (data.c) {
                    const current = data.c;
                    const prevClose = data.pc;
                    const change = current - prevClose;
                    const changePercent = (change / prevClose * 100).toFixed(2);

                    document.getElementById('stockPrice').textContent = '$' + current.toFixed(2);
                    
                    const changeEl = document.getElementById('stockChange');
                    changeEl.textContent = `${change >= 0 ? '+' : ''}${change.toFixed(2)} (${change >= 0 ? '+' : ''}${changePercent}%)`;
                    changeEl.className = 'stock-change ' + (change >= 0 ? 'up' : 'down');

                    document.getElementById('openPrice').textContent = '$' + data.o.toFixed(2);
                    document.getElementById('highPrice').textContent = '$' + data.h.toFixed(2);
                    document.getElementById('lowPrice').textContent = '$' + data.l.toFixed(2);
                    document.getElementById('prevClose').textContent = '$' + prevClose.toFixed(2);

                    // 获取市值
                    const profileRes = await fetch(`https://finnhub.io/api/v1/stock/profile2?symbol=${stock.symbol}&token=${API_KEY}`);
                    const profile = await profileRes.json();
                    if (profile.marketCapitalization) {
                        document.getElementById('marketCap').textContent = (profile.marketCapitalization / 1000).toFixed(2) + '万亿';
                    }

                    loadRelatedNews();
                } else {
                    document.getElementById('stockPrice').textContent = '数据获取失败';
                }
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('stockPrice').textContent = '加载失败，请检查API Key';
            }
        }

        function loadRelatedNews() {
            document.getElementById('relatedNews').innerHTML = `
                <div style="padding: 12px 0; border-bottom: 1px solid #f5f5f5; cursor: pointer;" onclick="location.href='news-detail.html?id=1'">
                    <div style="font-size: 14px; color: #333;">英伟达Q4营收681亿美元暴增73%，股价却大跌5.5%</div>
                    <div style="font-size: 12px; color: #999; margin-top: 5px;">2小时前 · 半导体 · 5.2万阅读</div>
                </div>
                <div style="padding: 12px 0; cursor: pointer;" onclick="location.href='news-detail.html?id=2'">
                    <div style="font-size: 14px; color: #333;">OpenAI完成1100亿美元融资，估值达8400亿美元</div>
                    <div style="font-size: 12px; color: #999; margin-top: 5px;">3小时前 · 人工智能 · 4.8万阅读</div>
                </div>
            `;
        }
    </script>
</body>
</html><!-- updated: 1772291008 -->
